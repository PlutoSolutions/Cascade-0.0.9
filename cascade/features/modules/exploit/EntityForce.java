/*
 * Decompiled with CFR 0.150.
 * 
 * Could not load the following classes:
 *  net.minecraft.client.gui.GuiDownloadTerrain
 *  net.minecraft.entity.Entity
 *  net.minecraft.network.Packet
 *  net.minecraft.network.play.client.CPacketVehicleMove
 *  net.minecraftforge.fml.common.eventhandler.SubscribeEvent
 */
package cascade.features.modules.exploit;

import cascade.event.events.UpdateWalkingPlayerEvent;
import cascade.features.modules.Module;
import net.minecraft.client.gui.GuiDownloadTerrain;
import net.minecraft.entity.Entity;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketVehicleMove;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

public class EntityForce
extends Module {
    private Entity entity;

    public EntityForce() {
        super("EntityForce", Module.Category.EXPLOIT, "Forces shit with entites");
    }

    @Override
    public void onEnable() {
        if (EntityForce.fullNullCheck()) {
            return;
        }
        if (EntityForce.mc.player.getRidingEntity() != null) {
            this.entity = EntityForce.mc.player.getRidingEntity();
            this.dismount();
        }
    }

    @Override
    public void onDisable() {
        if (EntityForce.fullNullCheck()) {
            return;
        }
        if (EntityForce.mc.player.getRidingEntity() == null) {
            this.remount();
        }
    }

    @SubscribeEvent
    public void onUpdateWalkingPlayer(UpdateWalkingPlayerEvent e) {
        if (EntityForce.fullNullCheck() || this.entity == null || e.getStage() == 1 || this.isDisabled()) {
            return;
        }
        if (EntityForce.mc.currentScreen instanceof GuiDownloadTerrain) {
            EntityForce.mc.currentScreen = null;
            return;
        }
        EntityForce.mc.player.motionY = 0.0;
        this.entity.motionY = 0.0;
        mc.getConnection().sendPacket((Packet)new CPacketVehicleMove(this.entity));
    }

    private void dismount() {
        if (EntityForce.mc.player.getRidingEntity() != null) {
            this.entity = EntityForce.mc.player.getRidingEntity();
            EntityForce.mc.player.dismountRidingEntity();
            EntityForce.mc.world.removeEntity(this.entity);
        }
    }

    private void remount() {
        if (this.entity == null) {
            return;
        }
        this.entity.isDead = false;
        EntityForce.mc.world.spawnEntity(this.entity);
        EntityForce.mc.player.startRiding(this.entity);
    }
}

